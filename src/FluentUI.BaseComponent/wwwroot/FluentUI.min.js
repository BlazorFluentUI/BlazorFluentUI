var FluentUIBaseComponent,FluentUICallout,FluentUIDocumentCard,FluentUIFocusTrapZone,FluentUIFocusZone,FluentUIList,FluentUIDetailsList,FluentUIMarqueeSelection,FluentUIPanel,FluentUISelectionZone,FluentUISlider,__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,l)}a((n=n.apply(e,t||[])).next())})};!function(e){const t="data-is-focusable",i="data-is-scrollable",n="data-is-visible",o="data-focuszone-id",s="data-is-sub-focuszone",r="ms-Fabric--isFocusVisible",l={};function a(e){window.document.body.classList.contains(r)&&window.document.body.classList.remove(r)}function c(e){var t;t=e.which,u[t]&&!window.document.body.classList.contains(r)&&window.document.body.classList.add(r)}e.initializeFocusRects=function(){window.__hasInitializeFocusRects__||(window.__hasInitializeFocusRects__=!0,window.addEventListener("mousedown",a,!0),window.addEventListener("keydown",c,!0))};const u={38:1,40:1,37:1,39:1,36:1,35:1,9:1,33:1,34:1};var d=0;e.enableBodyScroll=function(){d>0&&(1===d&&(document.body.classList.remove("disabledBodyScroll"),document.body.removeEventListener("touchmove",h)),d--)},e.disableBodyScroll=function(){d||(document.body.classList.add("disabledBodyScroll"),document.body.addEventListener("touchmove",h,{passive:!1,capture:!1})),d++};const h=e=>{e.preventDefault()};function m(e){let t=e;for(;t&&t!==document.body;){if("true"===t.getAttribute(i))return t;t=t.parentElement}for(t=e;t&&t!==document.body;){if("false"!==t.getAttribute(i)){const e=getComputedStyle(t);let i=e?e.getPropertyValue("overflow-y"):"";if(i&&("scroll"===i||"auto"===i))return t}t=t.parentElement}return t&&t!==document.body||(t=window),t}function f(e){return e.ownerDocument.defaultView}e.getClientHeight=function(e){return null==e?0:e.clientHeight},e.getScrollHeight=function(e){return null==e?0:e.scrollHeight},e.findScrollableParent=m,e.measureElement=function(e){return{width:e.clientWidth,height:e.clientHeight,left:0,top:0}},e.getNaturalBounds=function(e){return e&&null!==e?{width:e.naturalWidth,height:e.naturalHeight,left:0,top:0}:null},e.supportsObjectFit=function(){return void 0!==window&&void 0===window.navigator.msMaxTouchPoints},e.hasOverflow=function(e){return!1},e.measureScrollWindow=function(e){return{width:e.scrollWidth,height:e.scrollHeight,top:e.scrollTop,left:e.scrollLeft,bottom:e.scrollTop+e.clientHeight,right:e.scrollLeft+e.clientWidth}},e.measureScrollDimensions=function(e){return{scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth}},e.measureElementRect=function(e){if(void 0!==e&&null!==e){var t=e.getBoundingClientRect();return{height:t.height,width:t.width,left:t.left,right:t.right,top:t.top,bottom:t.bottom}}return{height:0,width:0,left:0,right:0,top:0,bottom:0}},e.getWindow=f,e.getWindowRect=function(){return{width:window.innerWidth,height:window.innerHeight,top:0,left:0}},e.getElementId=function(e){return void 0!==e?e.id:null};var p={},_={};e.registerKeyEventsForList=function(e){if(e instanceof HTMLElement){var t=v.newGuid();return _[t]=[e,t=>{let i;const n=t.altKey||t.metaKey;switch(t.keyCode){case 38:n||(i=I(e,e.lastChild,!0));break;case 40:n||(i=B(e,e.firstChild,!0));break;default:return}i&&i.focus()}],e.addEventListener("keydown",_[t][1]),t}return null},e.deregisterKeyEventsForList=function(e){var t=_[e];if(t){var i=t[0],n=t[1];i.removeEventListener("keydown",n),_[e]=null}},e.registerWindowKeyDownEvent=function(e,t,i){var n=v.newGuid();return p[n]=(n=>{n.code==t&&(n.preventDefault(),n.stopPropagation(),e.invokeMethodAsync(i,n.code))}),window.addEventListener("keydown",p[n]),n},e.deregisterWindowKeyDownEvent=function(e){var t=p[e];window.removeEventListener("keydown",t),p[e]=null},e.registerResizeEvent=function(e,t){var i=v.newGuid();return p[i]=U(i=>{e.invokeMethodAsync(t,window.innerWidth,innerHeight)},100,{leading:!0}),window.addEventListener("resize",p[i]),i},e.deregisterResizeEvent=function(e){var t=p[e];window.removeEventListener("resize",t),p[e]=null};class v{static newGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}}var g=0,w=new Map;class b{constructor(e,t,i=!1){this.RESIZE_DELAY=500,this.MAX_RESIZE_ATTEMPTS=3,this.viewport={width:0,height:0},this._onAsyncResizeAsync=(()=>{this._updateViewportAsync()}),this.id=g++,this.component=e,this.rootElement=t,this._onAsyncResizeAsync=U(this._onAsyncResizeAsync,this.RESIZE_DELAY,{leading:!0}),this.viewportResizeObserver=new window.ResizeObserver(this._onAsyncResizeAsync),this.viewportResizeObserver.observe(this.rootElement),i&&this._onAsyncResizeAsync()}disconnect(){this.viewportResizeObserver.disconnect()}_updateViewportAsync(e){return __awaiter(this,void 0,void 0,function*(){const t=this.rootElement,i=y(m(t)),n=y(t),o=()=>__awaiter(this,void 0,void 0,function*(){e&&(yield this.component.invokeMethodAsync("ForceUpdate"))});((n&&n.width)!==this.viewport.width||(i&&i.height)!==this.viewport.height)&&this._resizeAttempts<this.MAX_RESIZE_ATTEMPTS&&n&&i?(this._resizeAttempts++,this.viewport={width:n.width,height:i.height},yield this.component.invokeMethodAsync("ViewportChanged",this.viewport),yield this._updateViewportAsync(e)):(this._resizeAttempts=0,yield o())})}}function y(e){let t;return e&&(e===window?t={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect&&(t=e.getBoundingClientRect())),t}function E(e,t){return e&&e!==document.body?t(e)?e:E(k(e),t):null}function F(e,t){let i=E(e,e=>e.hasAttribute(t));return i&&i.getAttribute(t)}e.addViewport=function(e,t,i=!1){let n=new b(e,t,i);return w.set(n.id,n),n.id},e.removeViewport=function(e){w.get(e).disconnect(),w.delete(e)},e.getRect=y,e.findElementRecursive=E,e.elementContainsAttribute=F;var A={};function B(e,t,i){return z(e,t,!0,!1,!1,i)}function I(e,t,i){return S(e,t,!0,!1,!0,i)}function C(e,i){if(!e||e.disabled)return!1;let n=0,o=null;e&&e.getAttribute&&(o=e.getAttribute("tabIndex"))&&(n=parseInt(o,10));let s=e.getAttribute?e.getAttribute(t):null,r=null!==o&&n>=0;const l=!!e&&"false"!==s&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"true"===s||r);return i?-1!==n&&l:l}function T(e){if(!e||!e.getAttribute)return!1;const t=e.getAttribute(n);return null!==t&&void 0!==t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function k(e,t=!0){return e&&(t&&M(e)||e.parentNode&&e.parentNode)}function M(e){let t;return e&&e.dataset&&e.dataset.parentLayerId&&(t=l[e.dataset.parentLayerId]),t}function z(e,t,i,n,o,s,r,l){if(!t||t===e&&o&&!r)return null;let a=T(t);if(i&&a&&C(t,l))return t;if(!o&&a&&(s||!P(t)&&!L(t))){const i=z(e,t.firstElementChild,!0,!0,!1,s,r,l);if(i)return i}if(t===e)return null;const c=z(e,t.nextElementSibling,!0,!0,!1,s,r,l);return c||(n?null:z(e,t.parentElement,!1,!1,!0,s,r,l))}function S(e,t,i,n,o,s,r,l){if(!t||!r&&t===e)return null;let a=T(t);if(o&&a&&(s||!P(t)&&!L(t))){const i=S(e,t.lastElementChild,!0,!0,!0,s,r,l);if(i){if(l&&C(i,!0)||!l)return i;const n=S(e,i.previousElementSibling,!0,!0,!0,s,r,l);if(n)return n;let o=i.parentElement;for(;o&&o!==t;){const t=S(e,o.previousElementSibling,!0,!0,!0,s,r,l);if(t)return t;o=o.parentElement}}}if(i&&a&&C(t,l))return t;const c=S(e,t.previousElementSibling,!0,!0,!0,s,r,l);return c||(n?null:S(e,t.parentElement,!0,!1,!1,s,r,l))}function P(e){return!!(e&&e.getAttribute&&e.getAttribute(o))}function L(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(s))}function U(e,t,i){if(this._isDisposed){let e=()=>{};return e.cancel=(()=>{}),e.flush=(()=>null),e.pending=(()=>!1),e}let n,o,s=t||0,r=!1,l=!0,a=null,c=0,u=(new Date).getTime(),d=null;i&&"boolean"==typeof i.leading&&(r=i.leading),i&&"boolean"==typeof i.trailing&&(l=i.trailing),i&&"number"==typeof i.maxWait&&!isNaN(i.maxWait)&&(a=i.maxWait);let h=e=>{d&&(this.clearTimeout(d),d=null),u=e},m=t=>{h(t),n=e.apply(this._parent,o)},f=e=>{let t=(new Date).getTime(),i=!1;e&&(r&&t-c>=s&&(i=!0),c=t);let o=t-c,h=s-o,p=t-u,_=!1;return null!==a&&(p>=a&&d?_=!0:h=Math.min(h,a-p)),o>=s||_||i?m(t):null!==d&&e||!l||(d=this.setTimeout(f,h)),n},p=()=>!!d,_=(...e)=>(o=e,f(!0));return _.cancel=(()=>{p()&&h((new Date).getTime())}),_.flush=(()=>(p()&&m((new Date).getTime()),n)),_.pending=p,_}e.storeLastFocusedElement=function(){let e=document.activeElement;if(e){let t=v.newGuid();return A[t]=e,t}return null},e.restoreLastFocus=function(e,t=!0){var i=A[e];null!=i&&(t&&i.focus(),delete A[e])},e.getActiveElement=function(){return document.activeElement},e.focusElement=function(e){e.focus()},e.focusFirstElementChild=function(e){let t=this.getFirstFocusable(e,e,!0);t?t.focus():e.focus()},e.shouldWrapFocus=function(e,t){return"true"!==F(e,t)},e.getFocusableByIndexPath=function(e,t){let i=e;for(const e of t){const t=i.children[Math.min(e,i.children.length-1)];if(!t)break;i=t}return{element:i=C(i)&&T(i)?i:z(e,i,!0)||S(e,i),isNull:!i}},e.getFirstFocusable=B,e.getLastFocusable=I,e.isElementTabbable=C,e.isElementVisible=T,e.focusFirstChild=function(e){return!1},e.getParent=k,e.addOrUpdateVirtualParent=function(e){l[e.dataset.layerId]=e},e.getVirtualParent=M,e.elementContains=function(e,t,i=!0){let n=!1;if(e&&t)if(i)for(n=!1;t;){let i=k(t);if(i===e){n=!0;break}t=i}else e.contains&&(n=e.contains(t));return n},e.getNextElement=z,e.getPreviousElement=S,e.raiseClick=function(e){const t=function(e){let t;return"function"==typeof Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),t}("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)},e.isElementFocusZone=P,e.isElementFocusSubZone=L,e.on=function(e,t,i,n){return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i,n)},e.debounce=U;const R="isRTL";let x;function D(e,t=!1){let i=document;i&&i.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&O(R,e?"1":"0"),x=e}function N(e){let t=null;try{t=window.sessionStorage.getItem(e)}catch(e){}return t}function O(e,t){try{window.sessionStorage.setItem(e,t)}catch(e){}}e.getRTL=function(){if(void 0===x){let e=N(R);null!==e&&D(x="1"===e);let t=document;void 0===x&&t&&(x="rtl"===(t.body&&t.body.getAttribute("dir")||t.documentElement.getAttribute("dir")))}return!!x},e.setRTL=D,e.getItem=N,e.setItem=O;function Z(e,...t){return H.apply(this,[null,e].concat(t))}function H(e,t,...i){t=t||{};for(let n of i)if(n)for(let i in n)!n.hasOwnProperty(i)||e&&!e(i)||(t[i]=n[i]);return t}e.Async=class{constructor(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=(()=>{})}dispose(){let e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}}setTimeout(e,t){let i=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),i=setTimeout(()=>{try{this._timeoutIds&&delete this._timeoutIds[i],e.apply(this._parent)}catch(e){this._onErrorHandler&&this._onErrorHandler(e)}},t),this._timeoutIds[i]=!0),i}clearTimeout(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])}setImmediate(e,t){let i=0;const n=f(t);if(!this._isDisposed){this._immediateIds||(this._immediateIds={});let t=()=>{try{this._immediateIds&&delete this._immediateIds[i],e.apply(this._parent)}catch(e){this._logError(e)}};i=n.setTimeout(t,0),this._immediateIds[i]=!0}return i}clearImmediate(e,t){const i=f(t);this._immediateIds&&this._immediateIds[e]&&(i.clearTimeout(e),delete this._immediateIds[e])}setInterval(e,t){let i=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),i=setInterval(()=>{try{e.apply(this._parent)}catch(e){this._logError(e)}},t),this._intervalIds[i]=!0),i}clearInterval(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])}throttle(e,t,i){if(this._isDisposed)return this._noop;let n,o,s=t||0,r=!0,l=!0,a=0,c=null;i&&"boolean"==typeof i.leading&&(r=i.leading),i&&"boolean"==typeof i.trailing&&(l=i.trailing);let u=t=>{let i=(new Date).getTime(),d=i-a,h=r?s-d:s;return d>=s&&(!t||r)?(a=i,c&&(this.clearTimeout(c),c=null),n=e.apply(this._parent,o)):null===c&&l&&(c=this.setTimeout(u,h)),n};return(...e)=>(o=e,u(!0))}debounce(e,t,i){if(this._isDisposed){let e=()=>{};return e.cancel=(()=>{}),e.flush=(()=>null),e.pending=(()=>!1),e}let n,o,s=t||0,r=!1,l=!0,a=null,c=0,u=(new Date).getTime(),d=null;i&&"boolean"==typeof i.leading&&(r=i.leading),i&&"boolean"==typeof i.trailing&&(l=i.trailing),i&&"number"==typeof i.maxWait&&!isNaN(i.maxWait)&&(a=i.maxWait);let h=e=>{d&&(this.clearTimeout(d),d=null),u=e},m=t=>{h(t),n=e.apply(this._parent,o)},f=e=>{let t=(new Date).getTime(),i=!1;e&&(r&&t-c>=s&&(i=!0),c=t);let o=t-c,h=s-o,p=t-u,_=!1;return null!==a&&(p>=a&&d?_=!0:h=Math.min(h,a-p)),o>=s||_||i?m(t):null!==d&&e||!l||(d=this.setTimeout(f,h)),n},p=()=>!!d,_=(...e)=>(o=e,f(!0));return _.cancel=(()=>{p()&&h((new Date).getTime())}),_.flush=(()=>(p()&&m((new Date).getTime()),n)),_.pending=p,_}requestAnimationFrame(e,t){let i=0;const n=f(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});let t=()=>{try{this._animationFrameIds&&delete this._animationFrameIds[i],e.apply(this._parent)}catch(e){this._logError(e)}};i=n.requestAnimationFrame?n.requestAnimationFrame(t):n.setTimeout(t,0),this._animationFrameIds[i]=!0}return i}cancelAnimationFrame(e,t){const i=f(t);this._animationFrameIds&&this._animationFrameIds[e]&&(i.cancelAnimationFrame?i.cancelAnimationFrame(e):i.clearTimeout(e),delete this._animationFrameIds[e])}_logError(e){this._onErrorHandler&&this._onErrorHandler(e)}},e.assign=Z,e.filteredAssign=H;class W{constructor(e){this._id=W._uniqueId++,this._parent=e,this._eventRecords=[]}static raise(e,t,i,n){let o;if(W._isElement(e)){if("undefined"!=typeof document&&document.createEvent){let s=document.createEvent("HTMLEvents");s.initEvent(t,n||!1,!0),Z(s,i),o=e.dispatchEvent(s)}else if("undefined"!=typeof document&&document.createEventObject){let n=document.createEventObject(i);e.fireEvent("on"+t,n)}}else for(;e&&!1!==o;){let s=e.__events__,r=s?s[t]:null;if(r)for(let e in r)if(r.hasOwnProperty(e)){let t=r[e];for(let e=0;!1!==o&&e<t.length;e++){let n=t[e];n.objectCallback&&(o=n.objectCallback.call(n.parent,i))}}e=n?e.parent:null}return o}static isObserved(e,t){let i=e&&e.__events__;return!!i&&!!i[t]}static isDeclared(e,t){let i=e&&e.__declaredEvents;return!!i&&!!i[t]}static stopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}static _isElement(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)}dispose(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)}onAll(e,t,i){for(let n in t)t.hasOwnProperty(n)&&this.on(e,n,t[n],i)}on(e,t,i,n){if(t.indexOf(",")>-1){let o=t.split(/[ ,]+/);for(let t=0;t<o.length;t++)this.on(e,o[t],i,n)}else{let o=this._parent,s={target:e,eventName:t,parent:o,callback:i,options:n},r=e.__events__=e.__events__||{};if(r[t]=r[t]||{count:0},r[t][this._id]=r[t][this._id]||[],r[t][this._id].push(s),r[t].count++,W._isElement(e)){let r=(...e)=>{if(this._isDisposed)return;let t;try{if(!1===(t=i.apply(o,e))&&e[0]){let t=e[0];t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0}}catch(e){}return t};s.elementCallback=r,e.addEventListener?e.addEventListener(t,r,n):e.attachEvent&&e.attachEvent("on"+t,r)}else{let e=(...e)=>{if(!this._isDisposed)return i.apply(o,e)};s.objectCallback=e}this._eventRecords.push(s)}}off(e,t,i,n){for(let o=0;o<this._eventRecords.length;o++){let s=this._eventRecords[o];if(!(e&&e!==s.target||t&&t!==s.eventName||i&&i!==s.callback||"boolean"==typeof n&&n!==s.options)){let e=s.target.__events__,t=e[s.eventName],n=t?t[this._id]:null;n&&(1!==n.length&&i?(t.count--,n.splice(n.indexOf(s),1)):(t.count-=n.length,delete e[s.eventName][this._id]),t.count||delete e[s.eventName]),s.elementCallback&&(s.target.removeEventListener?s.target.removeEventListener(s.eventName,s.elementCallback,s.options):s.target.detachEvent&&s.target.detachEvent("on"+s.eventName,s.elementCallback)),this._eventRecords.splice(o--,1)}}}raise(e,t,i){return W.raise(this._parent,e,t,i)}declare(e){let t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(let i=0;i<e.length;i++)t[e[i]]=!0}}W._uniqueId=0,e.EventGroup=W}(FluentUIBaseComponent||(FluentUIBaseComponent={})),window.FluentUIBaseComponent=FluentUIBaseComponent,window.addEventListener("load",function(){var e=function(e){if(32===e.keyCode||" "===e.key)return e.preventDefault(),!1};function t(t,i){if(t instanceof HTMLElement){var n=t;n.classList.contains("prevent-default-on-space")&&i?n.addEventListener("keydown",e,!1):n.removeEventListener("keydown",e,!1)}}function i(e,i){for(var n=0;n<e.length;n++){var o=e[n];if(o instanceof HTMLElement){var s=o;t(o,i);for(var r=s.getElementsByClassName("prevent-default-on-space"),l=0;l<r.length;l++)t(r[l],i)}}}new MutationObserver(function(e){for(var n=0,o=e;n<o.length;n++){var s=o[n];"childList"===s.type?i(s.addedNodes,!0):"attributes"===s.type&&"class"===s.attributeName&&(t(s.target,!1),t(s.target,!0))}}).observe(document,{subtree:!0,childList:!0,attributes:!0}),i(document.getElementsByClassName("prevent-default-on-space"),!0)}),function(e){e.registerHandlers=function(e,n){var o=e.ownerDocument.defaultView,s=t.addCallout(e);return[t.addListener(o,"scroll",t=>{i(t,e)&&n.invokeMethodAsync("ScrollHandler")},!0),t.addListener(o,"resize",t=>{i(t,e)&&n.invokeMethodAsync("ResizeHandler")},!0),t.addListener(document.documentElement,"focus",e=>{var o=!0;for(let n in t.targetCombinedElements)if(Object.prototype.hasOwnProperty.call(t.targetCombinedElements,n)&&0==(o=i(e,t.targetCombinedElements[n])))break;o&&n.invokeMethodAsync("FocusHandler")},!0),t.addListener(document.documentElement,"click",e=>{var o=!0;for(let n in t.targetCombinedElements)if(Object.prototype.hasOwnProperty.call(t.targetCombinedElements,n)&&0==(o=i(e,t.targetCombinedElements[n])))break;o&&n.invokeMethodAsync("ClickHandler")},!0),s]},e.unregisterHandlers=function(e){t.removeCallout(e[e.length-1]);var i=e.slice(0,e.length-1);for(let e of i)t.removeListener(e)};class t{static addCallout(e){return this.targetCombinedElements[this.i]=e,this.i++}static removeCallout(e){e in this.targetCombinedElements&&delete this.targetCombinedElements[e]}static addListener(e,t,i,n){return e.addEventListener(t,i,n),this.listeners[this.i]={capture:n,event:t,handler:i,element:e},this.i++}static removeListener(e){if(e in this.listeners){var t=this.listeners[e];t.element.removeEventListener(t.event,t.handler,t.capture),delete this.listeners[e]}}}function i(e,t){return!function(e,t,i=!0){let o=!1;if(e&&t)if(i)for(o=!1;t;){let i=n(t);if(i===e){o=!0;break}t=i}else e.contains&&(o=e.contains(t));return o}(t,e.target)}function n(e){return e&&e.parentNode&&e.parentNode}t.i=1,t.listeners={},t.targetCombinedElements={},e.getWindow=function(e){return e.ownerDocument.defaultView},e.getWindowRect=function(){return{width:window.innerWidth,height:window.innerHeight,top:0,left:0}}}(FluentUICallout||(FluentUICallout={})),window.FluentUICallout=FluentUICallout||{},function(e){class t{stateChanged(){this.dotnet.invokeMethodAsync("UpdateTitle",this.state.truncatedTitleFirstPiece,this.state.truncatedTitleSecondPiece)}}class i{constructor(e){this.needMeasurement=!!e}}const n=new Array;function o(e){for(var t=0;t<n.length;t++)if(n[t].id===e)return n[t];return null}function s(e,o,s,l,a){let c=new t;c.state=new i(l),c.state.originalTitle=a,c.state.previousTitle=a,c.id=e,c.element=o,c.dotnet=s,c.state.watchResize=l,c.resizeFunction=(e=>{c.state.watchResize&&(c.state.watchResize=!1,setTimeout(()=>{console.log("resize"),c.dotnet.invokeMethodAsync("UpdateneedMeasurement"),c.state.truncatedTitleFirstPiece="",c.state.truncatedTitleSecondPiece="",r(c),c.state.watchResize=!0},500))}),window.addEventListener("resize",c.resizeFunction),n.push(c)}function r(e){if(!e)return;let t=document.getElementById(e.id);const i=getComputedStyle(t);if(i.width&&i.lineHeight&&i.height){const{clientWidth:n,scrollWidth:o}=t,s=Math.floor((parseInt(i.height,10)+5)/parseInt(i.lineHeight,10)),r=o/(parseInt(i.width,10)*s);if(r>1){const t=e.state.originalTitle.length/r-3;e.state.truncatedTitleFirstPiece=e.state.originalTitle.slice(0,t/2),e.state.truncatedTitleSecondPiece=e.state.originalTitle.slice(e.state.originalTitle.length-t/2),e.stateChanged()}}}e.getElement=o,e.addElement=s,e.removelement=function(e){let t=-1;for(let i=0;i<n.length;i++)if(n[i].id===e){t=i;break}if(t>=0){let e=n[t];window.removeEventListener("resize",e.resizeFunction),n.splice(t,1)}},e.initTitle=function(e,t,i,n,l){let a=o(e);null===a&&(s(e,t,i,n,l),function(e){e.state.needMeasurement&&requestAnimationFrame(t=>{r(e)})}(a=o(e)))}}(FluentUIDocumentCard||(FluentUIDocumentCard={})),function(e){const t="data-is-focusable",i="data-is-visible",n="data-focuszone-id",o="data-is-sub-focuszone";class s{constructor(e,t){this._hasFocus=!0,this._onRootFocus=(e=>{this._hasFocus=!0}),this._onRootBlur=(e=>{let t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement),FluentUIBaseComponent.elementContains(this._props.rootElement,t)||(this._hasFocus=!1)}),this._onFirstBumperFocus=(()=>{this._onBumperFocus(!0)}),this._onLastBumperFocus=(()=>{this._onBumperFocus(!1)}),this._onBumperFocus=(e=>{if(this._props.disabled)return;const t=e===this._hasFocus?this._props.lastBumper:this._props.firstBumper;if(this._props.rootElement){const i=e===this._hasFocus?function(e,t,i,n=!0){return function e(t,i,n,o,s,r,l,a){if(!i||!l&&i===t)return null;let c=u(i);if(s&&c&&(r||!h(i)&&!m(i))){const n=e(t,i.lastElementChild,!0,!0,!0,r,l,a);if(n){if(a&&d(n,!0)||!a)return n;const o=e(t,n.previousElementSibling,!0,!0,!0,r,l,a);if(o)return o;let s=n.parentElement;for(;s&&s!==i;){const i=e(t,s.previousElementSibling,!0,!0,!0,r,l,a);if(i)return i;s=s.parentElement}}}if(n&&c&&d(i,a))return i;const f=e(t,i.previousElementSibling,!0,!0,!0,r,l,a);if(f)return f;if(!o)return e(t,i.parentElement,!0,!1,!1,r,l,a);return null}(e,t,n,!1,!0,i,!1,!0)}(this._props.rootElement,t,!0,!1):function(e,t,i,n=!0){return c(e,t,n,!1,!1,i,!1,!0)}(this._props.rootElement,t,!0,!1);i&&(this._isBumper(i)?this.focus():i.focus())}}),this._props=e,this._dotNetRef=t,this._props.rootElement.addEventListener("focus",this._onRootFocus,!1),this._props.rootElement.addEventListener("blur",this._onRootBlur,!1),this._props.firstBumper.addEventListener("focus",this._onFirstBumperFocus,!1),this._props.lastBumper.addEventListener("focus",this._onLastBumperFocus,!1),this._bringFocusIntoZone()}unRegister(){this._props.rootElement.removeEventListener("focus",this._onRootFocus,!1),this._props.rootElement.removeEventListener("blur",this._onRootBlur,!1),this._props.firstBumper.removeEventListener("focus",this._onFirstBumperFocus,!1),this._props.lastBumper.removeEventListener("focus",this._onLastBumperFocus,!1)}updateProps(e){this._prevProps=this._props,this._props=e,!this._prevProps.forceFocusInsideTrap&&this._props.forceFocusInsideTrap||this._prevProps.disabled&&!this._props.disabled?this._bringFocusIntoZone():(this._prevProps.forceFocusInsideTrap&&!this._props.forceFocusInsideTrap||!this._prevProps.disabled&&this._props.disabled)&&this._returnFocusToInitiator()}setDisabled(e){this._props.disabled=e}_bringFocusIntoZone(){const{elementToFocusOnDismiss:e,disabled:t=!1,disableFirstFocus:i=!1,rootElement:n}=this._props;t||(s._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=e&&null!=e.__internalId?e:document.activeElement,i||FluentUIBaseComponent.elementContains(n,this._previouslyFocusedElementOutsideTrapZone)||this.focus())}_returnFocusToInitiator(){const{ignoreExternalFocusing:e,rootElement:t}=this._props;s._focusStack=s._focusStack.filter(e=>this!==e);const i=document.activeElement;e||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!FluentUIBaseComponent.elementContains(t,i)&&i!==document.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)}_focusAsync(e){this._isBumper(e)||function(e){if(e){if(a)return void(a=e);a=e,window.requestAnimationFrame(()=>{a&&a.focus(),a=void 0})}}(e)}_isBumper(e){return e===this._props.firstBumper||e===this._props.lastBumper}focus(){const{focusPreviouslyFocusedInnerElement:e,firstFocusableSelector:t,rootElement:i}=this._props;if(e&&this._previouslyFocusedElementInTrapZone&&FluentUIBaseComponent.elementContains(i,this._previouslyFocusedElementInTrapZone))return void this._focusAsync(this._previouslyFocusedElementInTrapZone);const n=t;let o=null;i&&(n&&(o=i.querySelector("."+n)),o||(o=c(i,i.firstChild,!1,!1,!1,!0))),o&&this._focusAsync(o)}}s._focusStack=[];var r=0,l={};e.register=function(e,t){let i=r++;return l[i]=new s(e,t),i},e.unregister=function(e){let t=l[e];t&&t.unRegister(),delete l[e]},e.updateProps=function(e,t){let i=l[e];i&&i.updateProps(t)},e.focus=function(e){let t=l[e];t&&t.focus()};let a=void 0;function c(e,t,i,n,o,s,r,l){if(!t||t===e&&o&&!r)return null;let a=u(t);if(i&&a&&d(t,l))return t;if(!o&&a&&(s||!h(t)&&!m(t))){const i=c(e,t.firstElementChild,!0,!0,!1,s,r,l);if(i)return i}if(t===e)return null;const f=c(e,t.nextElementSibling,!0,!0,!1,s,r,l);return f||(n?null:c(e,t.parentElement,!1,!1,!0,s,r,l))}function u(e){if(!e||!e.getAttribute)return!1;const t=e.getAttribute(i);return null!==t&&void 0!==t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function d(e,i){if(!e||e.disabled)return!1;let n=0,o=null;e&&e.getAttribute&&(o=e.getAttribute("tabIndex"))&&(n=parseInt(o,10));let s=e.getAttribute?e.getAttribute(t):null,r=null!==o&&n>=0;const l=!!e&&"false"!==s&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"true"===s||r);return i?-1!==n&&l:l}function h(e){return!!(e&&e.getAttribute&&e.getAttribute(n))}function m(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(o))}}(FluentUIFocusTrapZone||(FluentUIFocusTrapZone={})),window.FluentUIFocusTrapZone=FluentUIFocusTrapZone||{},function(e){let t,i;!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(t||(t={})),function(e){e[e.none=0]="none",e[e.all=1]="all",e[e.inputOnly=2]="inputOnly"}(i||(i={}));const n="data-is-focusable",o="data-focuszone-id",s="data-disable-click-on-enter",r="tabindex",l="data-no-vertical-wrap",a="data-no-horizontal-wrap",c=999999999,u=-999999999,d=["text","number","password","email","tel","url","search"],h=!1;var m=0,f={},p=new Set;let _;e.register=function(e,t){let i=m++;return f[i]=new v(e,t),i},e.unregister=function(e){let t=f[e];t&&t.unRegister(),delete f[e]},e.updateFocusZone=function(e,t){let i=f[e];i&&i.updateFocusZone(t)};class v{constructor(e,n){this._disposables=[],this._onBlur=(()=>{this._setParkedFocus(!1)}),this._onKeyDown=(e=>{if(this._portalContainsElement(e.target))return;const{direction:n,disabled:o,innerZoneKeystrokeTriggers:s}=this._focusZoneProps;if(!o&&!(e.defaultPrevented||document.activeElement===this._root&&this._isInnerZone)){if(s&&-1!=s.indexOf(e.keyCode)&&this._isImmediateDescendantOfZone(e.target)){const t=this._getFirstInnerZone();if(t){if(!t.focus(!0))return}else{if(!window.FluentUIBaseComponent.isElementFocusSubZone(e.target))return;if(!this.focusElement(window.FluentUIBaseComponent.getNextElement(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case 32:if(this._tryInvokeClickForFocusable(e.target))break;return;case 37:if(n!==t.vertical&&this._moveFocusLeft())break;return;case 39:if(n!==t.vertical&&this._moveFocusRight())break;return;case 38:if(n!==t.horizontal&&this._moveFocusUp())break;return;case 40:if(n!==t.horizontal&&this._moveFocusDown())break;return;case 9:if(this._focusZoneProps.handleTabKey===i.all||this._focusZoneProps.handleTabKey===i.inputOnly&&this._isElementInput(e.target)){let i=!1;if(this._processingTabKey=!0,n!==t.vertical&&this._shouldWrapFocus(this._activeElement,a)){if(n===t.horizontal||n===t.bidirectional){i=(window.FluentUIBaseComponent.getRTL()?!e.shiftKey:e.shiftKey)?this._moveFocusLeft():this._moveFocusRight()}}else i=e.shiftKey?this._moveFocusUp():this._moveFocusDown();if(this._processingTabKey=!1,i)break}return;case 36:if(this._isElementInput(e.target)&&!this._shouldInputLoseFocus(e.target,!1))return;const o=this._root&&this._root.firstChild;if(this._root&&o&&this.focusElement(window.FluentUIBaseComponent.getNextElement(this._root,o,!0)))break;return;case 35:if(this._isElementInput(e.target)&&!this._shouldInputLoseFocus(e.target,!0))return;const s=this._root&&this._root.lastChild;if(this._root&&this.focusElement(window.FluentUIBaseComponent.getPreviousElement(this._root,s,!0,!0,!0)))break;return;case 13:if(this._tryInvokeClickForFocusable(e.target))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}),this._onFocus=(e=>{if(this._portalContainsElement(e.target))return;const{doNotAllowFocusEventToPropagate:t}=this._focusZoneProps,i=this._isImmediateDescendantOfZone(e.target);let n;if(this._dotNetRef.invokeMethodAsync("JSOnFocusNotification"),i)n=e.target;else{let t=e.target;for(;t&&t!==this._root;){if(window.FluentUIBaseComponent.isElementTabbable(t)&&this._isImmediateDescendantOfZone(t)){n=t;break}t=window.FluentUIBaseComponent.getParent(t,h)}}const o=!this._activeElement;n&&n!==this._activeElement&&((i||o)&&this._setFocusAlignment(n,!0,!0),this._activeElement=n,o&&this._updateTabIndexes()),this._dotNetRef.invokeMethodAsync("JSOnActiveElementChanged"),t&&e.stopPropagation()}),this._onKeyDownCapture=(e=>{9===e.which&&p.forEach(e=>e._updateTabIndexes())}),this._onMouseDown=(e=>{if(this._portalContainsElement(e.target))return;const{disabled:t}=this._focusZoneProps;if(t)return;let i=e.target;const n=[];for(;i&&i!==this._root;)n.push(i),i=window.FluentUIBaseComponent.getParent(i,h);for(;n.length&&((i=n.pop())&&window.FluentUIBaseComponent.isElementTabbable(i)&&this._setActiveElement(i,!0),!window.FluentUIBaseComponent.isElementFocusZone(i)););}),this._root=e.root,this._focusZoneProps=e,this._dotNetRef=n,this._focusAlignment={x:0,y:0},this._root.addEventListener("keydown",this._onKeyDown,!1),this._root.addEventListener("focusin",this._onFocus,!1),this._root.addEventListener("mousedown",this._onMouseDown,!1),this.initialized()}updateFocusZone(e){if(this._focusZoneProps=e,f[e.id]=this,this._root){const e=window.FluentUIBaseComponent.getWindow(this._root);let t=window.FluentUIBaseComponent.getParent(this._root,h);for(;t&&t!==document.body&&1===t.nodeType;){if(window.FluentUIBaseComponent.isElementFocusZone(t)){this._isInnerZone=!0;break}t=window.FluentUIBaseComponent.getParent(t,h)}this._isInnerZone||p.add(this),e&&1===p.size&&(_=window.FluentUIBaseComponent.on(e,"keydown",this._onKeyDownCapture,!0)),this._disposables.push(window.FluentUIBaseComponent.on(this._root,"blur",this._onBlur,!0)),this._updateTabIndexes(),null!==this._focusZoneProps.defaultActiveElement.__internalId&&this._activeElement!=this._focusZoneProps.defaultActiveElement&&(this._activeElement=this._focusZoneProps.defaultActiveElement,this.focus())}}initialized(){const e=window.FluentUIBaseComponent.getWindow(this._root);let t=window.FluentUIBaseComponent.getParent(this._root,h);for(;t&&t!==document.body&&1===t.nodeType;){if(window.FluentUIBaseComponent.isElementFocusZone(t)){this._isInnerZone=!0;break}t=window.FluentUIBaseComponent.getParent(t,h)}this._isInnerZone||p.add(this),e&&1===p.size&&(_=window.FluentUIBaseComponent.on(e,"keydown",this._onKeyDownCapture,!0)),this._disposables.push(window.FluentUIBaseComponent.on(this._root,"blur",this._onBlur,!0)),this._updateTabIndexes(),null!==this._focusZoneProps.defaultActiveElement.__internalId&&(this._activeElement=this._focusZoneProps.defaultActiveElement,this.focus())}_setParkedFocus(e){this._root&&this._isParked!==e&&(this._isParked=e,e?(this._focusZoneProps.allowFocusRoot||(this._parkedTabIndex=this._root.getAttribute("tabindex"),this._root.setAttribute("tabindex","-1")),this._root.focus()):this._focusZoneProps.allowFocusRoot||(this._parkedTabIndex?(this._root.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):this._root.removeAttribute("tabindex")))}unRegister(){this._isInnerZone||p.delete(this),this._disposables.forEach(e=>e()),0===p.size&&_&&_(),this._root.removeEventListener("keydown",this._onKeyDown,!1),this._root.removeEventListener("focus",this._onFocus,!1),this._root.removeEventListener("mousedown",this._onMouseDown,!1)}focus(e=!1){if(this._root){if(!e&&"true"===this._root.getAttribute(n)&&this._isInnerZone){const e=this._getOwnerZone(this._root);if(e!==this._root){const t=f[e.getAttribute(o)];return!!t&&t.focusElement(this._root)}return!1}if(!e&&this._activeElement&&window.FluentUIBaseComponent.elementContains(this._root,this._activeElement)&&window.FluentUIBaseComponent.isElementTabbable(this._activeElement))return this._activeElement.focus(),!0;{const e=this._root.firstChild;return this.focusElement(window.FluentUIBaseComponent.getNextElement(this._root,e,!0))}}return!1}focusElement(e){const{onBeforeFocusExists:t}=this._focusZoneProps;return!(t&&!this._dotNetRef.invokeMethodAsync("JSOnBeforeFocus"))&&(!!e&&(this._setActiveElement(e),this._activeElement&&this._activeElement.focus(),!0))}_updateTabIndexes(e){!e&&this._root&&(this._defaultFocusElement=null,e=this._root,this._activeElement&&!window.FluentUIBaseComponent.elementContains(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!window.FluentUIBaseComponent.isElementTabbable(this._activeElement)&&(this._activeElement=null);const t=e&&e.children;for(let e=0;t&&e<t.length;e++){const i=t[e];window.FluentUIBaseComponent.isElementFocusZone(i)?"true"===i.getAttribute(n)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(r)&&i.setAttribute(r,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(r)&&i.setAttribute(r,"0"))):(i.getAttribute&&"false"===i.getAttribute(n)&&i.setAttribute(r,"-1"),window.FluentUIBaseComponent.isElementTabbable(i)?this._focusZoneProps.disabled?i.setAttribute(r,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(r)&&i.setAttribute(r,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(r)&&i.setAttribute(r,"0")):"svg"===i.tagName&&"false"!==i.getAttribute("focusable")&&i.setAttribute("focusable","false")),this._updateTabIndexes(i)}}_getOwnerZone(e){let t=window.FluentUIBaseComponent.getParent(e,h);for(;t&&t!==this._root&&t!==document.body;){if(window.FluentUIBaseComponent.isElementFocusZone(t))return t;t=window.FluentUIBaseComponent.getParent(t,h)}return t}_setActiveElement(e,t){const i=this._activeElement;this._activeElement=e,i&&(window.FluentUIBaseComponent.isElementFocusZone(i)&&this._updateTabIndexes(i),i.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)}_setFocusAlignment(e,i,n){if(this._focusZoneProps.direction===t.bidirectional&&(!this._focusAlignment||i||n)){const t=e.getBoundingClientRect(),o=t.left+t.width/2,s=t.top+t.height/2;this._focusAlignment||(this._focusAlignment={x:o,y:s}),i&&(this._focusAlignment.x=o),n&&(this._focusAlignment.y=s)}}_isImmediateDescendantOfZone(e){return this._getOwnerZone(e)===this._root}_getFirstInnerZone(e){if(!(e=e||this._activeElement||this._root))return null;if(window.FluentUIBaseComponent.isElementFocusZone(e))return f[e.getAttribute(o)];let t=e.firstElementChild;for(;t;){if(window.FluentUIBaseComponent.isElementFocusZone(t))return f[t.getAttribute(o)];const e=this._getFirstInnerZone(t);if(e)return e;t=t.nextElementSibling}return null}_tryInvokeClickForFocusable(e){if(e===this._root)return!1;do{if("BUTTON"===e.tagName||"A"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName)return!1;if(this._isImmediateDescendantOfZone(e)&&"true"===e.getAttribute(n)&&"true"!==e.getAttribute(s))return window.FluentUIBaseComponent.raiseClick(e),!0;e=window.FluentUIBaseComponent.getParent(e,h)}while(e!==this._root);return!1}_portalContainsElement(e){return!1}_isElementInput(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())}_shouldInputLoseFocus(e,t){if(!this._processingTabKey&&e&&e.type&&d.indexOf(e.type.toLowerCase())>-1){const i=e.selectionStart,n=i!==e.selectionEnd,o=e.value;if(n||i>0&&!t||i!==o.length&&t||this._focusZoneProps.handleTabKey&&(!this._focusZoneProps.shouldInputLoseFocusOnArrowKeyExists||!this._dotNetRef.invokeMethodAsync("JSShouldInputLoseFocusOnArrowKey")))return!1}return!0}_shouldWrapFocus(e,t){return!this._focusZoneProps.checkForNoWrap||window.FluentUIBaseComponent.shouldWrapFocus(e,t)}_moveFocus(e,i,n,o=!0){let s=this._activeElement,r=-1,l=void 0,a=!1;const c=this._focusZoneProps.direction===t.bidirectional;if(!s||!this._root)return!1;if(this._isElementInput(s)&&!this._shouldInputLoseFocus(s,e))return!1;const u=c?s.getBoundingClientRect():null;do{if(s=e?window.FluentUIBaseComponent.getNextElement(this._root,s):window.FluentUIBaseComponent.getPreviousElement(this._root,s),!c){l=s;break}if(s){const e=i(u,s.getBoundingClientRect());if(-1===e&&-1===r){l=s;break}if(e>-1&&(-1===r||e<r)&&(r=e,l=s),r>=0&&e<0)break}}while(s);if(l&&l!==this._activeElement)a=!0,this.focusElement(l);else if(this._focusZoneProps.isCircularNavigation&&o)return e?this.focusElement(window.FluentUIBaseComponent.getNextElement(this._root,this._root.firstElementChild,!0)):this.focusElement(window.FluentUIBaseComponent.getPreviousElement(this._root,this._root.lastElementChild,!0,!0,!0));return a}_moveFocusDown(){let e=-1;const t=this._focusAlignment.x;return!!this._moveFocus(!0,(i,n)=>{let o=-1;const s=Math.floor(n.top),r=Math.floor(i.bottom);return s<r?this._shouldWrapFocus(this._activeElement,l)?c:u:((-1===e&&s>=r||s===e)&&(e=s,o=t>=n.left&&t<=n.left+n.width?0:Math.abs(n.left+n.width/2-t)),o)})&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)}_moveFocusUp(){let e=-1;const t=this._focusAlignment.x;return!!this._moveFocus(!1,(i,n)=>{let o=-1;const s=Math.floor(n.bottom),r=Math.floor(n.top),a=Math.floor(i.top);return s>a?this._shouldWrapFocus(this._activeElement,l)?c:u:((-1===e&&s<=a||r===e)&&(e=r,o=t>=n.left&&t<=n.left+n.width?0:Math.abs(n.left+n.width/2-t)),o)})&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)}_moveFocusLeft(){const e=this._shouldWrapFocus(this._activeElement,a);return!!this._moveFocus(window.FluentUIBaseComponent.getRTL(),(i,n)=>{let o,s=-1;return(o=window.FluentUIBaseComponent.getRTL()?parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)):parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)))&&n.right<=i.right&&this._focusZoneProps.direction!==t.vertical?s=i.right-n.right:e||(s=u),s},void 0,e)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)}_moveFocusRight(){const e=this._shouldWrapFocus(this._activeElement,a);return!!this._moveFocus(!window.FluentUIBaseComponent.getRTL(),(i,n)=>{let o,s=-1;return(o=window.FluentUIBaseComponent.getRTL()?parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)):parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)))&&n.left>=i.left&&this._focusZoneProps.direction!==t.vertical?s=n.left-i.left:e||(s=u),s},void 0,e)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)}}}(FluentUIFocusZone||(FluentUIFocusZone={})),window.FluentUIFocusZone=FluentUIFocusZone||{},function(e){var t=0,i=new Map;class n{constructor(e,i,n){this.cachedSizes=new Map,this.averageHeight=40,this.id=t++,this.component=e,this.scrollElement=FluentUIBaseComponent.findScrollableParent(i),this.component.invokeMethodAsync("ResizeHandler",this.scrollElement.clientWidth),this.events=new FluentUIBaseComponent.EventGroup(this),this.events.on(window,"resize",this.resize),this.rootElement=i.parentElement,this.spacerBefore=i,this.spacerAfter=n;this.intersectionObserver=new IntersectionObserver((t,i)=>{t.forEach(t=>{var i;if(!t.isIntersecting)return;const n=this.spacerBefore.getBoundingClientRect(),o=this.spacerAfter.getBoundingClientRect().top-n.bottom,s=null===(i=t.rootBounds)||void 0===i?void 0:i.height;t.target===this.spacerBefore?e.invokeMethodAsync("OnBeforeSpacerVisible",t.intersectionRect.top-t.boundingClientRect.top,o,s):t.target===this.spacerAfter&&this.spacerAfter.offsetHeight>0&&e.invokeMethodAsync("OnAfterSpacerVisible",t.boundingClientRect.bottom-t.intersectionRect.bottom,o,s)})},{root:this.scrollElement,rootMargin:"50px"}),this.intersectionObserver.observe(this.spacerBefore),this.intersectionObserver.observe(this.spacerAfter),this.mutationObserverBefore=new MutationObserver(()=>{this.intersectionObserver.unobserve(this.spacerBefore),this.intersectionObserver.observe(this.spacerBefore)}),this.mutationObserverBefore.observe(this.spacerBefore,{attributes:!0}),this.mutationObserverAfter=new MutationObserver(()=>{this.intersectionObserver.unobserve(this.spacerAfter),this.intersectionObserver.observe(this.spacerAfter)}),this.mutationObserverAfter.observe(this.spacerAfter,{attributes:!0})}resize(e){this.component.invokeMethodAsync("ResizeHandler",this.scrollElement.clientWidth)}disconnect(){this.events.off(window,"resize",this.resize),this.events.dispose(),this.mutationObserverBefore.disconnect(),this.mutationObserverAfter.disconnect(),this.intersectionObserver.unobserve(this.spacerBefore),this.intersectionObserver.unobserve(this.spacerAfter),this.intersectionObserver.disconnect()}getAverageHeight(){let e=!1,t=0,i={};for(let t=0;t<this.surfaceElement.children.length;t++){let n=this.surfaceElement.children.item(t),o=n.getAttribute("data-item-index");null==o||this.cachedSizes.has(o)||this.cachedSizes.get(o)==n.clientHeight||(this.cachedSizes.set(o,n.clientHeight),i[o]=n.clientHeight,e=!0)}return e&&(this.component.invokeMethodAsync("UpdateHeightCache",i),t=[...this.cachedSizes.values()].reduce((e,t,i,n)=>e+t)/this.cachedSizes.size),t}updateItemHeights(){}}e.getInitialAverageHeight=function(e){let t=i.get(e);return null==t?0:t.getAverageHeight()},e.initialize=function(e,t,o,s=!1){let r=new n(e,t,o);return i.set(r.id,r),r.id},e.removeList=function(e){i.get(e).disconnect(),i.delete(e)},e.getViewport=function(e){return{top:0,left:0,width:e.clientWidth,height:e.clientHeight,bottom:e.scrollHeight,right:e.scrollWidth}}}(FluentUIList||(FluentUIList={})),window.FluentUIList=FluentUIList||{},function(e){const t=0,i=new Map;e.registerDetailsHeader=function(e,t){let o=new n(e,t);i.set(e._id,o)},e.unregisterDetailsHeader=function(e){i.get(e._id).dispose(),i.delete(e._id)};class n{constructor(e,i){this._onRootMouseDown=(e=>__awaiter(this,void 0,void 0,function*(){const i=e.target.getAttribute("data-sizer-index"),n=Number(i);null!==i&&e.button===t&&(yield this.dotNet.invokeMethodAsync("OnSizerMouseDown",n,e.clientX),e.preventDefault(),e.stopPropagation())})),this._onRootDblClick=(e=>__awaiter(this,void 0,void 0,function*(){const i=e.target.getAttribute("data-sizer-index"),n=Number(i);null!==i&&e.button===t&&(yield this.dotNet.invokeMethodAsync("OnDoubleClick",n))})),this.dotNet=e,this.root=i,this.events=new FluentUIBaseComponent.EventGroup(this),this.events.on(i,"mousedown",this._onRootMouseDown),this.events.on(i,"dblclick",this._onRootDblClick)}dispose(){this.events.dispose()}}}(FluentUIDetailsList||(FluentUIDetailsList={})),window.FluentUIDetailsList=FluentUIDetailsList||{},function(e){function t(e,t){const i=e.left||0,n=e.top||0,o=t.left||0,s=t.top||0;return Math.sqrt(Math.pow(i-o,2)+Math.pow(n-s,2))}e.getDistanceBetweenPoints=t;const i=16,n=100,o=15;function s(e){let t;return e&&(e===window?t={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect&&(t=e.getBoundingClientRect())),t}e.getRect=s;class r{constructor(e){this._events=new FluentUIBaseComponent.EventGroup(this),this._scrollableParent=FluentUIBaseComponent.findScrollableParent(e),this._incrementScroll=this._incrementScroll.bind(this),this._scrollRect=s(this._scrollableParent),this._scrollableParent===window&&(this._scrollableParent=document.body),this._scrollableParent&&(this._events.on(window,"mousemove",this._onMouseMove,!0),this._events.on(window,"touchmove",this._onTouchMove,!0))}dispose(){this._events.dispose(),this._stopScroll()}_onMouseMove(e){this._computeScrollVelocity(e)}_onTouchMove(e){e.touches.length>0&&this._computeScrollVelocity(e)}_computeScrollVelocity(e){if(!this._scrollRect)return;let t,i;"clientX"in e?(t=e.clientX,i=e.clientY):(t=e.touches[0].clientX,i=e.touches[0].clientY);let s,r,l,a=this._scrollRect.top,c=this._scrollRect.left,u=a+this._scrollRect.height-n,d=c+this._scrollRect.width-n;i<a+n||i>u?(r=i,s=a,l=u,this._isVerticalScroll=!0):(r=t,s=c,l=d,this._isVerticalScroll=!1),this._scrollVelocity=r<s+n?Math.max(-o,(n-(r-s))/n*-o):r>l?Math.min(o,o*((r-l)/n)):0,this._scrollVelocity?this._startScroll():this._stopScroll()}_startScroll(){this._timeoutId||this._incrementScroll()}_incrementScroll(){this._scrollableParent&&(this._isVerticalScroll?this._scrollableParent.scrollTop+=Math.round(this._scrollVelocity):this._scrollableParent.scrollLeft+=Math.round(this._scrollVelocity)),this._timeoutId=setTimeout(this._incrementScroll,i)}_stopScroll(){this._timeoutId&&(clearTimeout(this._timeoutId),delete this._timeoutId)}}e.AutoScroll=r;const l=new Map;e.registerMarqueeSelection=function(e,t,i){let n=new c(e,t,i);l.set(e._id,n)},e.updateProps=function(e,t){var i=l.get(e._id);null!==i&&(i.props=t)},e.unregisterMarqueeSelection=function(e){l.get(e._id).dispose(),l.delete(e._id)};const a=5;class c{constructor(e,t,i){this.onMouseDown=(e=>__awaiter(this,void 0,void 0,function*(){if(!this._isMouseEventOnScrollbar(e)&&!this._isInSelectionToggle(e)&&!this.isTouch&&this.props.isEnabled&&!this._isDragStartInSelection(e)){(yield this.dotNet.invokeMethodAsync("OnShouldStartSelectionInternal"))&&this.scrollableSurface&&0===e.button&&this.root&&(this._selectedIndicies={},this._preservedIndicies=void 0,this.events.on(window,"mousemove",this._onAsyncMouseMove,!0),this.events.on(this.scrollableParent,"scroll",this._onAsyncMouseMove),this.events.on(window,"click",this.onMouseUp,!0),this.autoScroll=new r(this.root),this._scrollTop=this.scrollableSurface.scrollTop,this._scrollLeft=this.scrollableSurface.scrollLeft,this._rootRect=this.root.getBoundingClientRect(),yield this._onMouseMove(e))}})),this.dotNet=e,this.root=t,this.props=i,this.events=new FluentUIBaseComponent.EventGroup(this),this._async=new FluentUIBaseComponent.Async(this),this.scrollableParent=FluentUIBaseComponent.findScrollableParent(t),this.scrollableSurface=this.scrollableParent===window?document.body:this.scrollableParent;const n=i.isDraggingConstrainedToRoot?this.root:this.scrollableSurface;this.events.on(n,"mousedown",this.onMouseDown)}updateProps(e){this.props=e,this._itemRectCache={}}dispose(){this.autoScroll&&this.autoScroll.dispose(),delete this.scrollableParent,delete this.scrollableSurface,this.events.dispose(),this._async.dispose()}_isMouseEventOnScrollbar(e){const t=e.target;if(t.offsetWidth-t.clientWidth){const i=t.getBoundingClientRect();if(e.clientX>i.left+t.clientWidth)return!0;if(e.clientY>i.top+t.clientHeight)return!0}return!1}_getRootRect(){return{left:this._rootRect.left+(this._scrollLeft-this.scrollableSurface.scrollLeft),top:this._rootRect.top+(this._scrollTop-this.scrollableSurface.scrollTop),width:this._rootRect.width,height:this._rootRect.height}}_onAsyncMouseMove(e){this.animationFrameRequest=window.requestAnimationFrame(()=>__awaiter(this,void 0,void 0,function*(){yield this._onMouseMove(e)})),e.stopPropagation(),e.preventDefault()}_onMouseMove(e){return __awaiter(this,void 0,void 0,function*(){if(!this.autoScroll)return;void 0!==e.clientX&&(this._lastMouseEvent=e);const i=this._getRootRect(),n={left:e.clientX-i.left,top:e.clientY-i.top};if(this._dragOrigin||(this._dragOrigin=n),void 0!==e.buttons&&0===e.buttons)this.onMouseUp(e);else if(this._mirroredDragRect||t(this._dragOrigin,n)>a){this._mirroredDragRect||(e.shiftKey||(yield this.dotNet.invokeMethodAsync("UnselectAll")),this._preservedIndicies=yield this.dotNet.invokeMethodAsync("GetSelectedIndicesAsync"));const t=this.props.isDraggingConstrainedToRoot?{left:Math.max(0,Math.min(i.width,this._lastMouseEvent.clientX-i.left)),top:Math.max(0,Math.min(i.height,this._lastMouseEvent.clientY-i.top))}:{left:this._lastMouseEvent.clientX-i.left,top:this._lastMouseEvent.clientY-i.top};this.dragRect={left:Math.min(this._dragOrigin.left||0,t.left),top:Math.min(this._dragOrigin.top||0,t.top),width:Math.abs(t.left-(this._dragOrigin.left||0)),height:Math.abs(t.top-(this._dragOrigin.top||0))},yield this._evaluateSelectionAsync(this.dragRect,i),this._mirroredDragRect=this.dragRect,yield this.dotNet.invokeMethodAsync("SetDragRect",this.dragRect)}return!1})}_evaluateSelectionAsync(e,t){return __awaiter(this,void 0,void 0,function*(){if(!e||!this.root)return;const i=this.root.querySelectorAll("[data-selection-index]");this._itemRectCache||(this._itemRectCache={});for(let n=0;n<i.length;n++){const o=i[n],s=o.getAttribute("data-selection-index");let r=this._itemRectCache[s];r||(r={left:(r=o.getBoundingClientRect()).left-t.left,top:r.top-t.top,width:r.width,height:r.height,right:r.left-t.left+r.width,bottom:r.top-t.top+r.height}).width>0&&r.height>0&&(this._itemRectCache[s]=r),r.top<e.top+e.height&&r.bottom>e.top&&r.left<e.left+e.width&&r.right>e.left?this._selectedIndicies[s]=!0:delete this._selectedIndicies[s]}const n=this._allSelectedIndices||{};this._allSelectedIndices={};for(const e in this._selectedIndicies)this._selectedIndicies.hasOwnProperty(e)&&(this._allSelectedIndices[e]=!0);if(this._preservedIndicies)for(const e of this._preservedIndicies)this._allSelectedIndices[e]=!0;let o=!1;for(const e in this._allSelectedIndices)if(this._allSelectedIndices[e]!==n[e]){o=!0;break}if(!o)for(const e in n)if(this._allSelectedIndices[e]!==n[e]){o=!0;break}if(o){yield this.dotNet.invokeMethodAsync("SetChangeEvents",!1),yield this.dotNet.invokeMethodAsync("UnselectAll");const e=[];for(const t of Object.keys(this._allSelectedIndices))e.push(Number(t));yield this.dotNet.invokeMethodAsync("SetSelectedIndices",e),yield this.dotNet.invokeMethodAsync("SetChangeEvents",!0)}})}onMouseUp(e){this.events.off(window),this.events.off(this.scrollableParent,"scroll"),this.autoScroll&&this.autoScroll.dispose(),this.autoScroll=this._dragOrigin=this._lastMouseEvent=void 0,this._selectedIndicies=this._itemRectCache=void 0,this._mirroredDragRect&&(this._mirroredDragRect=null,this.dotNet.invokeMethodAsync("SetDragRect",null),e.preventDefault(),e.stopPropagation())}_isInSelectionToggle(e){let t=e.target;for(;t&&t!==this.root;){if("true"===t.getAttribute("data-selection-toggle"))return!0;t=t.parentElement}return!1}_isDragStartInSelection(e){const t=this.root.querySelectorAll("[data-is-selected]");for(let i=0;i<t.length;i++){const n=t[i].getBoundingClientRect();if(this._isPointInRectangle(n,{left:e.clientX,top:e.clientY}))return!0}return!1}_isPointInRectangle(e,t){return!!t.top&&e.top<t.top&&e.bottom>t.top&&!!t.left&&e.left<t.left&&e.right>t.left}}}(FluentUIMarqueeSelection||(FluentUIMarqueeSelection={})),window.FluentUIMarqueeSelection=FluentUIMarqueeSelection||{},function(e){class t{static addListener(e,t,i,n){return e.addEventListener(t,i,n),this.listeners[this.i]={capture:n,event:t,handler:i,element:e},this.i++}static removeListener(e){if(e in this.listeners){var t=this.listeners[e];t.element.removeEventListener(t.event,t.handler,t.capture),delete this.listeners[e]}}}t.i=1,t.listeners={},e.registerSizeHandler=function(e){return t.addListener(window,"resize",t=>{e.invokeMethodAsync("UpdateFooterPositionAsync")},!1)},e.registerMouseDownHandler=function(e,i){return t.addListener(document.body,"mousedown",t=>{if(!t.defaultPrevented){var n=FluentUIBaseComponent.elementContains(e,t.target);n||(t.preventDefault(),i.invokeMethodAsync("DismissOnOuterClick",n))}},!0)},e.unregisterHandler=function(e){t.removeListener(e)};const i="data-is-scrollable";e.makeElementScrollAllower=function(e){let n=0,o=null;return[t.addListener(e,"touchstart",e=>{1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)},!1),t.addListener(e,"touchmove",e=>{if(1!==e.targetTouches.length)return;if(e.stopPropagation(),!o)return;const t=e.targetTouches[0].clientY-n,s=function(e){let t=e;for(;t&&t!==document.body;){if("true"===t.getAttribute(i))return t;t=t.parentElement}for(t=e;t&&t!==document.body;){if("false"!==t.getAttribute(i)){const e=getComputedStyle(t);let i=e?e.getPropertyValue("overflow-y"):"";if(i&&("scroll"===i||"auto"===i))return t}t=t.parentElement}return t&&t!==document.body||(t=window),t}(e.target);s&&(o=s),0===o.scrollTop&&t>0&&e.preventDefault(),o.scrollHeight-o.scrollTop<=o.clientHeight&&t<0&&e.preventDefault()},!1)]}}(FluentUIPanel||(FluentUIPanel={})),window.FluentUIPanel=FluentUIPanel||{},function(e){const t="data-selection-disabled",i="data-selection-index",n="data-selection-toggle",o="data-selection-invoke",s="data-selection-touch-invoke",r="data-selection-all-toggle",l="data-selection-select",a=new Map;let c;e.registerSelectionZone=function(e,t,i){let n=new u(e,t,i);a.set(e._id,n)},e.updateProps=function(e,t){let i=a.get(e._id);null!==i&&(i.props=t)},e.unregisterSelectionZone=function(e){a.get(e._id).dispose(),a.delete(e._id)},function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(c=e.SelectionMode||(e.SelectionMode={}));class u{constructor(e,t,i){this.ignoreNextFocus=(()=>{this._handleNextFocus(!1)}),this._onMouseDownCapture=(e=>{let t=e.target;if(document.activeElement===t||FluentUIBaseComponent.elementContains(document.activeElement,t)){if(FluentUIBaseComponent.elementContains(t,this.root))for(;t!==this.root;){if(this._hasAttribute(t,o)){this.ignoreNextFocus();break}t=FluentUIBaseComponent.getParent(t)}}else this.ignoreNextFocus()}),this._onMouseDown=(e=>__awaiter(this,void 0,void 0,function*(){this._updateModifiers(e);let t=e.target;const i=yield this._findItemRootAsync(t);if(!this._isSelectionDisabled(t))for(;t!==this.root&&!this._hasAttribute(t,r);){if(i){if(this._hasAttribute(t,n))break;if(this._hasAttribute(t,o))break;if(!(t!==i&&!this._shouldAutoSelect(t)||this._isShiftPressed||this._isCtrlPressed||this._isMetaPressed)){yield this._onInvokeMouseDownAsync(e,this._getItemIndex(i));break}if(this.props.disableAutoSelectOnInputElements&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName))return}t=FluentUIBaseComponent.getParent(t)}})),this._onClick=(e=>__awaiter(this,void 0,void 0,function*(){this._updateModifiers(e);let t=e.target;const i=yield this._findItemRootAsync(t),l=this._isSelectionDisabled(t);for(;t!==this.root;){if(this._hasAttribute(t,r)){l||(yield this._onToggleAllClickAsync(e));break}if(i){const r=this._getItemIndex(i);if(this._hasAttribute(t,n)){l||(this._isShiftPressed?yield this._onItemSurfaceClickAsync(e,r):yield this._onToggleClickAsync(e,r));break}if(this._isTouch&&this.props.enableTouchInvocationTarget&&this._hasAttribute(t,s)||this._hasAttribute(t,o)){yield this._onInvokeClickAsync(e,r);break}if(t===i){l?yield this.dotNet.invokeMethodAsync("InvokeItem",r):yield this._onItemSurfaceClickAsync(e,r);break}if("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName)return}t=FluentUIBaseComponent.getParent(t)}})),this.dotNet=e,this.root=t,this.props=i;const l=FluentUIBaseComponent.getWindow(this.root);this._events=new FluentUIBaseComponent.EventGroup(this),this._async=new FluentUIBaseComponent.Async(this),this._events.on(l,"keydown",this._updateModifiers),this._events.on(t,"mousedown",this._onMouseDown),this._events.on(t,"mousedown",this._onMouseDownCapture,{capture:!0}),this._events.on(t,"click",this._onClick)}updateProps(e){this.props=e}dispose(){this._events.dispose(),this._async.dispose()}_updateModifiers(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;const t=e.keyCode;this._isTabPressed=!!t&&9===t}_onInvokeMouseDownAsync(e,t){return __awaiter(this,void 0,void 0,function*(){(yield this.dotNet.invokeMethodAsync("IsIndexSelected",t))||(yield this._clearAndSelectIndexAsync(t))})}_clearAndSelectIndexAsync(e){return __awaiter(this,void 0,void 0,function*(){let t=!1;(yield this.dotNet.invokeMethodAsync("GetSelectedCount"))&&(t=yield this.dotNet.invokeMethodAsync("IsIndexSelected",e));if(!t){const t=this.props.isModal;yield this.dotNet.invokeMethodAsync("SetChangeEvents",!1),yield this.dotNet.invokeMethodAsync("SetAllSelected",!1),yield this.dotNet.invokeMethodAsync("SetIndexSelected",e,!0,!0),(t||this.props.enterModalOnTouch&&this._isTouch)&&(yield this.dotNet.invokeMethodAsync("SetModal",!0),this._isTouch&&this._setIsTouch(!1)),yield this.dotNet.invokeMethodAsync("SetChangeEvents",!0)}})}_setIsTouch(e){this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout(()=>{this._isTouch=!1},300)}_hasAttribute(e,t){let i=!1;for(;!i&&e!==this.root;)i="true"===e.getAttribute(t),e=FluentUIBaseComponent.getParent(e);return i}_handleNextFocus(e){this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout(()=>{this._shouldHandleFocus=!1},100)}_findItemRootAsync(e){return __awaiter(this,void 0,void 0,function*(){for(;e!==this.root;){const t=e.getAttribute(i),n=Number(t);if(null!==t&&n>=0){if(n<(yield this.dotNet.invokeMethodAsync("GetItemsLength")))break}e=FluentUIBaseComponent.getParent(e)}if(e!==this.root)return e})}_isSelectionDisabled(e){if(this.props.selectionMode===c.none)return!0;for(;e!==this.root;){if(this._hasAttribute(e,t))return!0;e=FluentUIBaseComponent.getParent(e)}return!1}_shouldAutoSelect(e){return this._hasAttribute(e,l)}_getItemIndex(e){return Number(e.getAttribute(i))}_onToggleAllClickAsync(e){return __awaiter(this,void 0,void 0,function*(){this.props.selectionMode===c.multiple&&(yield this.dotNet.invokeMethodAsync("ToggleAllSelected"),e.stopPropagation(),e.preventDefault())})}_onToggleClickAsync(e,t){return __awaiter(this,void 0,void 0,function*(){const i=this.props.selectionMode;if(yield this.dotNet.invokeMethodAsync("SetChangeEvents",!1),this.props.enterModalOnTouch&&this._isTouch){(yield this.dotNet.invokeMethodAsync("IsIndexSelected",t))||(yield this.dotNet.invokeMethodAsync("SetModal",!0),this._setIsTouch(!1))}if(i===c.multiple)yield this.dotNet.invokeMethodAsync("ToggleIndexSelected",t);else{if(i!==c.single)return void(yield this.dotNet.invokeMethodAsync("SetChangeEvents",!0));{let e=yield this.dotNet.invokeMethodAsync("IsIndexSelected",t);const i=this.props.isModal;yield this.dotNet.invokeMethodAsync("SetAllSelected",!1),yield this.dotNet.invokeMethodAsync("SetIndexSelected",t,!e,!0),i&&(yield this.dotNet.invokeMethodAsync("SetModal",!0))}}yield this.dotNet.invokeMethodAsync("SetChangeEvents",!0),e.stopPropagation()})}_onItemSurfaceClickAsync(e,t){return __awaiter(this,void 0,void 0,function*(){const e=this._isCtrlPressed||this._isMetaPressed,i=this.props.selectionMode;i===c.multiple?this._isShiftPressed&&!this._isTabPressed?yield this.dotNet.invokeMethodAsync("SelectToIndex",t,!e):e?yield this.dotNet.invokeMethodAsync("ToggleIndexSelected",t):yield this._clearAndSelectIndexAsync(t):i===c.single&&(yield this._clearAndSelectIndexAsync(t))})}_onInvokeClickAsync(e,t){return __awaiter(this,void 0,void 0,function*(){this.props.onItemInvokeSet&&(yield this.dotNet.invokeMethodAsync("InvokeItem",t),e.preventDefault(),e.stopPropagation())})}}}(FluentUISelectionZone||(FluentUISelectionZone={})),window.FluentUISelectionZone=FluentUISelectionZone||{},function(e){class t{static addListener(e,t,i,n,o){let s;this.objectListeners.has(e)?s=this.objectListeners.get(e):(s=new Map,this.objectListeners.set(e,s)),t.addEventListener(i,n,o),s.set(i,{capture:o,event:i,handler:n,element:t})}static removeListener(e,t){if(this.objectListeners.has(e)){let n=this.objectListeners.get(e);if(n.has(t)){var i=n.get(t);i.element.removeEventListener(i.event,i.handler,i.capture)}n.delete[t]}}}function i(e,i,o){"mousedown"===o.type?(t.addListener(e,window,"mousemove",t=>{n(e,i,t)},!0),t.addListener(e,window,"mouseup",t=>{s(e,i,t)},!0)):"touchstart"===o.type&&(t.addListener(e,window,"touchmove",t=>{n(e,i,t)},!0),t.addListener(e,window,"touchend",t=>{s(e,i,t)},!0)),n(e,i,o,!0)}function n(e,t,i,n){let s=t.getBoundingClientRect(),r=o(i,!1),l=o(i,!0);e.invokeMethodAsync("MouseOrTouchMove",s,r,l),n&&(i.preventDefault(),i.stopPropagation())}function o(e,t){let i;switch(e.type){case"mousedown":case"mousemove":i=t?e.clientY:e.clientX;break;case"touchstart":case"touchmove":i=t?e.touches[0].clientY:e.touches[0].clientX}return i}function s(e,i,n,o){return __awaiter(this,void 0,void 0,function*(){yield e.invokeMethodAsync("MouseOrTouchEnd"),"mouseup"===n.type?(t.removeListener(e,"mousemove"),t.removeListener(e,"mouseup")):"touchend"===n.type&&(t.removeListener(e,"touchmove"),t.removeListener(e,"touchend"))})}t.objectListeners=new Map,e.registerMouseOrTouchStart=function(e,n,o){t.addListener(e,n,"mousedown",t=>{i(e,o,t)},!0),t.addListener(e,n,"touchstart",t=>{i(e,o,t)},!0),t.addListener(e,n,"keydown",t=>{!function(e,t){switch(t.which){case 39:case 38:e.invokeMethodAsync("OnKeyDown",{step:1});break;case 37:case 40:e.invokeMethodAsync("OnKeyDown",{step:-1});break;case 36:e.invokeMethodAsync("OnKeyDown",{min:!0});break;case 35:e.invokeMethodAsync("OnKeyDown",{max:!0});break;default:return}t.preventDefault(),t.stopPropagation()}(e,t)},!0)},e.unregisterHandlers=function(e){t.removeListener(e,"mousedown"),t.removeListener(e,"touchstart"),t.removeListener(e,"keydown")}}(FluentUISlider||(FluentUISlider={})),window.FluentUISlider=FluentUISlider||{},function(e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():window.idleCallbackShim=e()}(function(){"use strict";var e,t,i,n,o,s,r,l,a="undefined"!=typeof window?window:void 0!=typeof global?global:this||{},c=a.cancelRequestAnimationFrame&&a.requestAnimationFrame||setTimeout,u=a.cancelRequestAnimationFrame||clearTimeout,d=[],h=0,m=!1,f=7,p=35,_=125,v=0,g=0,w=0,b={get didTimeout(){return!1},timeRemaining:function(){var e=f-(Date.now()-g);return e<0?0:e}},y=(o=function(){f=22,_=66,p=0},l=function(){var e=Date.now()-r;e<99?s=setTimeout(l,99-e):(s=null,o())},function(){r=Date.now(),s||(s=setTimeout(l,99))});function E(){125!=_&&(f=7,_=125,p=35,m&&(m&&(n&&u(n),i&&clearTimeout(i),m=!1),B())),y()}function F(){n=null,i=setTimeout(I,0)}function A(){i=null,c(F)}function B(){m||(t=_-(Date.now()-g),e=Date.now(),m=!0,p&&t<p&&(t=p),t>9?i=setTimeout(A,t):(t=0,A()))}function I(){var n,o,s,r=f>9?9:1;if(g=Date.now(),m=!1,i=null,h>2||g-t-50<e)for(o=0,s=d.length;o<s&&b.timeRemaining()>r;o++)n=d.shift(),w++,n&&n(b);d.length?B():h=0}function C(e){return v++,d.push(e),B(),v}function T(e){var t=e-1-w;d[t]&&(d[t]=null)}if(a.requestIdleCallback&&a.cancelIdleCallback)try{a.requestIdleCallback(function(){},{timeout:0})}catch(e){!function(e){var t,i;if(a.requestIdleCallback=function(t,i){return i&&"number"==typeof i.timeout?e(t,i.timeout):e(t)},a.IdleCallbackDeadline&&(t=IdleCallbackDeadline.prototype)){if(!(i=Object.getOwnPropertyDescriptor(t,"timeRemaining"))||!i.configurable||!i.get)return;Object.defineProperty(t,"timeRemaining",{value:function(){return i.get.call(this)},enumerable:!0,configurable:!0})}}(a.requestIdleCallback)}else a.requestIdleCallback=C,a.cancelIdleCallback=T,a.document&&document.addEventListener&&(a.addEventListener("scroll",E,!0),a.addEventListener("resize",E),document.addEventListener("focus",E,!0),document.addEventListener("mouseover",E,!0),["click","keypress","touchstart","mousedown"].forEach(function(e){document.addEventListener(e,E,{capture:!0,passive:!0})}),a.MutationObserver&&new MutationObserver(E).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}));return{request:C,cancel:T}});